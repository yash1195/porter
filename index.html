<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <title>porter-js</title>
    <meta name="generator" content="Hugo 0.15" />

    
    <meta name="description" content="Simple, unobtrusive File Upload (Local , Amazon S3) for Node.js.">
    
    <link rel="canonical" href="https://yash1195.github.io/porter/">
    
    <meta name="author" content="Yash Choukse">
    

    <meta property="og:url" content="https://yash1195.github.io/porter/">
    <meta property="og:title" content="porter-js">
    <meta property="og:image" content="https://yash1195.github.io/porter/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="porter-js">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://yash1195.github.io/porter/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://yash1195.github.io/porter/images/favicon.ico">


    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://yash1195.github.io/porter/fonts/icon.eot?52m981');
        src: url('https://yash1195.github.io/porter/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('https://yash1195.github.io/porter/fonts/icon.woff?52m981')
               format('woff'),
             url('https://yash1195.github.io/porter/fonts/icon.ttf?52m981')
               format('truetype'),
             url('https://yash1195.github.io/porter/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://yash1195.github.io/porter/stylesheets/application.css">
    <link rel="stylesheet" href="https://yash1195.github.io/porter/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://yash1195.github.io/porter/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://yash1195.github.io/porter/stylesheets/highlight/highlight.css">
    <link rel="stylesheet" href="https://yash1195.github.io/porter/stylesheets/custom.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu%2bMono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://yash1195.github.io/porter/javascripts/modernizr.js"></script>

    
    <link href="https://yash1195.github.io/porter/index.xml" rel="alternate" type="application/rss+xml" title="porter-js" />
    <link href="https://yash1195.github.io/porter/index.xml" rel="feed" type="application/rss+xml" title="porter-js" />
    

  </head>
  <body class="palette-primary-red palette-accent-light green">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        porter-js
        <i class="fa fa-space-shuttle" aria-hidden="true" class="porter-logo" class='red'></i>
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/yash1195" title="@yash1195 on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
     
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/yash1195/porter" class="project">
    <div class="banner">
      
        <div class="logo">
          <i class="fa fa-space-shuttle" style="font-size:70px !important" aria-hidden="true"></i>
        </div>
      
      <div class="name">
        <i class="fa fa-space-shuttle" aria-hidden="true"></i>
        <strong>porter-js <span class="version">0.0.0</span></strong>
        
          <br>
          yash1195/porter
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a class="current" title="Porter" href="https://yash1195.github.io/porter/">
	
	Porter
</a>


<ul id="scrollspy">
</ul>

  
</li>



<li>
  
    



<a  title="MIT License" href="https://opensource.org/licenses/MIT">
	
	MIT License
</a>


  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/yash1195" target="_blank" title="@yash1195 on GitHub">
              @yash1195 on GitHub
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			
				<h1>porter-js </h1>

				

<h2 id="documentation-for-porter-js">Documentation for porter-js</h2>

<p>porter-js is <a href="http://sailsjs.org/">Sails.js</a> compatible file uploading module for <a href="https://nodejs.org/en/">Node.js</a></p>

<p>porter-js can be easily integrated with any Sails.js (will support other frameworks in the future).</p>

<p>porter&rsquo;s purpose is to upload files to a sails server locally. You can opt to transfer the files to Amazon S3. This transfer will <strong>NOT</strong> be done by the main Node.js server. A different node process will do all the heavy lifting. Meanwhile, the file will always be available for usage.
Just add an asset to porter and the rest will be done  for you.</p>

<p>Currently, it needs <a href="https://www.mongodb.com/">MongoDB</a>. (will support other dbs in future releases)</p>

<h2 id="features">Features</h2>

<ul>
<li><p>Upload images from user to sails server. ( Saved locally )</p></li>

<li><p>Once an image is added, a token is returned. Only this token is required to fetch back the image.</p></li>

<li><p>Background node process transfers images from local storage to Amazon S3</p></li>

<li><p>Files are deleted from local storage once transferred.</p></li>

<li><p>Image available for usage at all times.</p></li>
</ul>

<h2 id="installation">Installation</h2>

<p>Go to your sails project.</p>

<p>Example</p>

<pre><code class="language-sh">/porter_demo 
</code></pre>

<p>Install with:</p>

<pre><code class="language-sh">$ npm install --save porter-js
</code></pre>

<h2 id="usage">Usage</h2>

<p>Sample HTML form</p>

<pre><code class="language-sh">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
	...
&lt;/head&gt;
&lt;body&gt;
	&lt;form action=&quot;/test&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
		&lt;input type=&quot;file&quot; name=&quot;file1&quot;&gt;
		&lt;button type=&quot;submit&quot;&gt;Upload&lt;/button&gt;
	&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h3 id="run-the-background-process-which-will-upload-files-to-the-cloud">Run the background process which will upload files to the cloud</h3>

<pre><code class="language-sh">
Make sure mongodb is running

Go to your sails project

$ cd porter_demo

Go to the porter-js module
$ cd node_modules/porter-js
$ sudo forever start --minUptime 1 --spinSleepTime 1 porter_service.js
</code></pre>

<h3 id="to-require-porter-js">To require porter-js</h3>

<pre><code class="language-sh">var porter = require('porter-js');
</code></pre>

<h3 id="porter-logs">porter logs</h3>

<pre><code class="language-sh">porter.logs(false);		// Logs can be set to false
				// Logging is enabled by default
</code></pre>

<h3 id="adding-a-file-saved-only-at-the-server">Adding a file (Saved only at the server)</h3>

<pre><code class="language-sh">var obj = req.file('file1');

porter
	.addAsset(obj)
	.then(function(token){
		console.log(token); // r159wEJd
						// Porter token for the uploaded file
	}); 
</code></pre>

<p><em>.addAsset returns a bluebird promise which resolves into a token</em></p>

<p><em>porter uses Skipper to implement streaming file uploads.</em></p>

<h3 id="retrieving-the-file">Retrieving the file</h3>

<pre><code class="language-sh">
porter
	.getAsset(obj)
	.then(function(data){
		console.log(data);	//  response
	}); 
</code></pre>

<p>Response will be of the form</p>

<pre><code class="language-sh">{
  &quot;isResized&quot;: false,
  &quot;inCloud&quot;: false,
  &quot;token_id&quot;: &quot;r159wEJd&quot;,
  &quot;url&quot;: &quot;/Users/yashchoukse/Documents/codes/web/porter_demo/.tmp/uploads/671fa97c.jpg&quot;
}
</code></pre>

<p><em>.getAsset returns a bluebird promise which resolves into file data</em></p>

<h3 id="adding-a-file-amazon-s3-cloud">Adding a file (Amazon S3 Cloud)</h3>

<p>Configuration needs to be set for Amazon S3 bucket</p>

<pre><code class="language-sh">var bucket = {
	key: 'AMAZON_S3_KEY',
	secret: 'AMAZON_S3_SECRET',
	bucket: 'AMAZON_S3_BUCKET'
}
</code></pre>

<p>Adding the file</p>

<pre><code class="language-sh">var obj = req.file('file1');

porter
	.addAsset(obj,bucket)
	.then(function(token){
		console.log(token);	// r159wEJd - Porter token for the uploaded file
	}); 
</code></pre>

<p><em>.addAsset returns a bluebird promise which resolves into a token</em></p>

<p><em>porter uses Skipper to implement streaming file uploads.</em></p>

<h3 id="retrieving-the-file-1">Retrieving the file</h3>

<pre><code class="language-sh">
porter
	.getAsset(obj)
	.then(function(data){
		console.log(data);	//  response
	}); 
</code></pre>

<p>Response will be of the form</p>

<pre><code class="language-sh">{
  &quot;isResized&quot;: false,
  &quot;inCloud&quot;: true,
  &quot;token_id&quot;: &quot;S1tN2N1_&quot;,
  &quot;url&quot;: &quot;https://s3.amazonaws.com/AMAZON_S3_BUCKET/raw_images/b25b4f9c-44c1.jpg&quot;
}
</code></pre>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>A big thank you to ##<a href="https://github.com/ravitejaobelisk">Ravi teja</a>. He mentored and helped me in creating this library.</p>

<p>Furthermore, a big thank you to <a href="http://www.nineleaps.com/">Nineleaps Technology Solutions</a> for supporting open source development of this module.</p>

<p>Furthermore, thanks to <a href="https://gihub.com/spf13">Steve Francia</a> for creating Hugo and the <a href="https://github.com/spf13/hugo/graphs/contributors">awesome community</a> around the hugo project.</p>

			

			<aside class="copyright" role="note">
				
				&copy; 2016 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/yash1195.github.io\/porter\/';
      var repo_id  = 'yash1195\/porter';
    
    </script>

    <script src="https://yash1195.github.io/porter/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;
            
            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }
        

        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
